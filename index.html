<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Real Flip Physics</title>
<style>
body {
  margin: 0;
  overflow: hidden;
  background: #1e2f45;
}
#score {
  position: absolute;
  top: 10px;
  left: 10px;
  color: white;
  font-family: Arial;
  font-size: 18px;
}
</style>
</head>
<body>

<div id="score">Ð¡Ð°Ð»ÑŒÑ‚Ð¾: 0</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
<script>

const { Engine, Render, Runner, Bodies, Body, Composite, Events } = Matter;

const engine = Engine.create();
engine.gravity.y = 1.4;

const render = Render.create({
  element: document.body,
  engine: engine,
  options: {
    width: window.innerWidth,
    height: window.innerHeight,
    wireframes: false,
    background: '#1e2f45'
  }
});

Render.run(render);
Runner.run(Runner.create(), engine);

const ground = Bodies.rectangle(
  window.innerWidth/2,
  window.innerHeight*0.8,
  window.innerWidth,
  40,
  { isStatic: true, render: { fillStyle: '#111' } }
);

Composite.add(engine.world, [ground]);

// ðŸ”¥ Ð¦Ð•Ð›Ð¬ÐÐžÐ• Ð¢Ð•Ð›Ðž
const player = Bodies.rectangle(
  window.innerWidth/2,
  window.innerHeight*0.5,
  40,
  120,
  {
    density: 0.004,
    friction: 0.8,
    restitution: 0.1,
    render: { fillStyle: '#2e7d32' }
  }
);

Composite.add(engine.world, player);

let flipCount = 0;
let canJump = false;

Events.on(engine, "collisionStart", function(event) {
  event.pairs.forEach(pair => {
    if (pair.bodyA === player || pair.bodyB === player) {
      canJump = true;
      player.angle = 0;
      player.angularVelocity = 0;
    }
  });
});

function jump() {
  if (!canJump) return;

  canJump = false;

  // Ð¡Ð¸Ð»Ð° Ð¿Ñ€Ñ‹Ð¶ÐºÐ°
  Body.applyForce(player, player.position, { x: 0, y: -0.25 });

  // Ð Ð°Ð½Ð´Ð¾Ð¼ Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ
  const dir = Math.random() > 0.5 ? 1 : -1;
  Body.setAngularVelocity(player, 0.3 * dir);
}

window.addEventListener("click", jump);
window.addEventListener("touchstart", jump);

let lastAngle = 0;

Events.on(engine, "afterUpdate", function() {
  const angleDiff = player.angle - lastAngle;

  if (Math.abs(player.angle) > Math.PI * 2) {
    flipCount++;
    document.getElementById("score").innerText = "Ð¡Ð°Ð»ÑŒÑ‚Ð¾: " + flipCount;
    Body.setAngle(player, 0);
  }

  lastAngle = player.angle;
});

</script>
</body>
</html>
