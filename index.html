<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Flip Game</title>
<style>
body {
  margin: 0;
  overflow: hidden;
  background: #1e2f45;
}
canvas {
  display: block;
}
#score {
  position: absolute;
  top: 10px;
  left: 10px;
  color: white;
  font-family: Arial;
  font-size: 18px;
}
</style>
</head>
<body>

<div id="score">Сальто: 0</div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

const groundY = () => canvas.height * 0.66;

const player = {
  x: () => canvas.width / 2,
  y: canvas.height * 0.4,
  width: 50,
  height: 120,
  velocityY: 0,
  rotation: 0,
  angularVelocity: 0,
  isOnGround: false,
  flipCount: 0,
  flipDirection: 1
};

function jump() {
  if (player.isOnGround) {
    player.velocityY = -18;
    player.isOnGround = false;

    // Рандом направление флипа
    player.flipDirection = Math.random() > 0.5 ? 1 : -1;
    player.angularVelocity = 0.25 * player.flipDirection;
  }
}

canvas.addEventListener("click", jump);
canvas.addEventListener("touchstart", jump);

function update() {
  player.velocityY += 0.9;
  player.y += player.velocityY;

  if (!player.isOnGround) {
    player.rotation += player.angularVelocity;
  }

  // Столкновение с землей
  if (player.y + player.height / 2 > groundY()) {
    player.y = groundY() - player.height / 2;
    player.velocityY = 0;
    player.angularVelocity = 0;
    player.rotation = 0;
    player.isOnGround = true;
  }

  // Подсчет полного оборота
  if (Math.abs(player.rotation) >= Math.PI * 2) {
    player.rotation = 0;
    player.flipCount++;
    document.getElementById("score").innerText = "Сальто: " + player.flipCount;
  }
}

function drawGround() {
  ctx.fillStyle = "#111";
  ctx.fillRect(0, groundY(), canvas.width, canvas.height - groundY());
}

function drawPlayer() {
  ctx.save();
  ctx.translate(player.x(), player.y);
  ctx.rotate(player.rotation);

  // Тело
  ctx.fillStyle = "#2e7d32";
  ctx.fillRect(-20, -40, 40, 80);

  // Голова
  ctx.beginPath();
  ctx.arc(0, -65, 22, 0, Math.PI * 2);
  ctx.fillStyle = "#f1c27d";
  ctx.fill();

  // Ноги
  ctx.fillStyle = "#1b5e20";
  ctx.fillRect(-15, 40, 10, 40);
  ctx.fillRect(5, 40, 10, 40);

  ctx.restore();
}

function loop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  update();
  drawGround();
  drawPlayer();
  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
